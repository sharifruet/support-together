
INSERT INTO `Users` (`id`, `name`, `email`, `phoneNumber`, `password`, `createdAt`, `updatedAt`) VALUES
(1, 'Sharif', 'sharifruet@gmail.com', '1710455190', '$2b$10$.OxaAxo/Q4pjQWY.sScTWeNsLLf8qORie7qU66VDautltxrc2sDmO', '2024-05-05 10:31:54', '2024-05-05 10:31:54'),
(2, 'Raihan Wahid', 'raihan@i2gether.com', '01716155239', '$2b$10$.OxaAxo/Q4pjQWY.sScTWeNsLLf8qORie7qU66VDautltxrc2sDmO', '2024-06-02 13:20:50', '2024-06-02 16:29:32'),
(3, 'pequ', 'pequ@i2gether.com', '01827680713', '$2b$10$.OxaAxo/Q4pjQWY.sScTWeNsLLf8qORie7qU66VDautltxrc2sDmO', '2024-06-03 05:23:59', '2024-06-03 05:28:05');


-- --------------------------------------------------------

INSERT INTO `Organizations` (`id`, `code`, `name`, `address`, `createdAt`, `updatedAt`) VALUES
(1, 'TIL', 'Together Initiatives', '1234 Main St', '2024-05-06 10:09:03', '2024-05-24 12:07:28');

-- --------------------------------------------------------

--
-- Dumping data for table `Projects`
--

INSERT INTO `Projects` (`id`, `code`, `name`, `description`, `createdAt`, `updatedAt`, `OrganizationId`) VALUES
(1, 'EBPM', 'Ebpm', 'Together ebpm', '2024-06-02 13:19:22', '2024-06-02 13:19:22', 1);

-- --------------------------------------------------------


-- Triggers `Tickets`
--
DELIMITER $$
CREATE TRIGGER `before_insert_ticket` BEFORE INSERT ON `Tickets` FOR EACH ROW BEGIN
    DECLARE project_code VARCHAR(255);
    DECLARE ticket_count INT;

    -- Fetch the project code
    SELECT code INTO project_code FROM Projects WHERE id = (SELECT projectId FROM Topics WHERE id = NEW.topicId);

    -- Count existing tickets for the project
    SELECT COUNT(*) + 1 INTO ticket_count FROM Tickets t 
    INNER JOIN Topics t1 ON (t.topicId = t1.id)
    INNER JOIN Topics t2 ON (t1.ProjectId = t2.ProjectId)
    WHERE t2.id = NEW.topicId;

    -- Set the code for the new ticket
    SET NEW.code = CONCAT(project_code, '-', ticket_count);
END
$$
DELIMITER ;





-- --------------------------------------------------------


INSERT INTO `Topics` (`id`, `name`, `description`, `createdAt`, `updatedAt`, `ProjectId`) VALUES
(2, 'New Issue', 'Description of Topic 1', '2024-05-08 12:36:32', '2024-05-08 12:36:32', 1),
(3, 'Old Issue', 'Description of Topic 1', '2024-05-08 12:36:56', '2024-05-08 12:36:56', 1);

-- --------------------------------------------------------

--
-- Dumping data for table `UserRoles`
--


INSERT INTO `UserRoles` (`id`, `role`, `createdAt`, `updatedAt`, `UserId`, `ProjectId`) VALUES
(1, 'Admin', '2024-05-06 10:12:44', '2024-05-06 10:12:44', 1, 1),
(2, 'Customer', '2024-06-02 13:19:48', '2024-06-02 13:19:48', 2, 1),
(3, 'Support', '2024-06-02 13:21:09', '2024-06-02 13:21:09', 3, 1);

-- --------------------------------------------------------

INSERT INTO `EmailTemplates` (`id`, `name`, `subject`, `body`, `createdAt`, `updatedAt`) VALUES
	(1, 'TICKET-CREATE', 'Ticket {code} has been created', '<div style="font-family:-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif;background:#f4f4f5;padding:24px;margin:0;"><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:0 auto;"><tr><td style="background:#fff;border-radius:8px;padding:32px 40px;box-shadow:0 1px 3px rgba(0,0,0,0.08);"><table role="presentation" cellpadding="0" cellspacing="0" width="100%"><tr><td style="padding-bottom:20px;border-bottom:1px solid #e4e4e7;"><img src="https://support.i2gether.com/support-together.png" alt="Support Together" style="max-height:48px;display:block;" /></td></tr></table><h2 style="font-size:18px;font-weight:600;color:#18181b;margin:24px 0 8px;">Hi {name},</h2><p style="font-size:15px;line-height:1.6;color:#52525b;margin:0 0 20px;">Your support ticket has been created successfully. Here are the details:</p><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="border-collapse:collapse;margin:0 0 24px;"><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Ticket</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{code}</td></tr><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Title</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{title}</td></tr><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Created</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{createdAt}</td></tr></table><p style="margin:0 0 24px;"><a href="https://support.i2gether.com/" style="display:inline-block;background:#2563eb;color:#fff;padding:12px 24px;border-radius:6px;text-decoration:none;font-weight:600;font-size:15px;">View ticket</a></p><p style="font-size:13px;color:#71717a;margin:0;">This email was sent to {email}. If you did not create this ticket, you can ignore it.</p></td></tr></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:24px auto 0;"><tr><td style="padding-top:20px;border-top:1px solid #e4e4e7;font-size:13px;color:#71717a;text-align:center;">Powered by <a href="https://www.i2gether.com" style="color:#2563eb;text-decoration:none;">Together Initiatives (p) Limited</a></td></tr></table></div>', '2024-05-25 16:58:51', '2024-05-29 09:44:34'),
	(2, 'TICKET-UPDATE', 'Update on ticket {code}', '<div style="font-family:-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif;background:#f4f4f5;padding:24px;margin:0;"><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:0 auto;"><tr><td style="background:#fff;border-radius:8px;padding:32px 40px;box-shadow:0 1px 3px rgba(0,0,0,0.08);"><table role="presentation" cellpadding="0" cellspacing="0" width="100%"><tr><td style="padding-bottom:20px;border-bottom:1px solid #e4e4e7;"><img src="https://support.i2gether.com/support-together.png" alt="Support Together" style="max-height:48px;display:block;" /></td></tr></table><h2 style="font-size:18px;font-weight:600;color:#18181b;margin:24px 0 8px;">Hi {name},</h2><p style="font-size:15px;line-height:1.6;color:#52525b;margin:0 0 20px;">There is an update on your support ticket. Here are the details:</p><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="border-collapse:collapse;margin:0 0 24px;"><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Ticket</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{code}</td></tr><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Title</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{title}</td></tr><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Created</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{createdAt}</td></tr><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Status</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{status}</td></tr></table><p style="margin:0 0 24px;"><a href="https://support.i2gether.com/" style="display:inline-block;background:#2563eb;color:#fff;padding:12px 24px;border-radius:6px;text-decoration:none;font-weight:600;font-size:15px;">View ticket</a></p><p style="font-size:13px;color:#71717a;margin:0;">This email was sent to {email}. If you did not expect this, you can ignore it.</p></td></tr></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:24px auto 0;"><tr><td style="padding-top:20px;border-top:1px solid #e4e4e7;font-size:13px;color:#71717a;text-align:center;">Powered by <a href="https://www.i2gether.com" style="color:#2563eb;text-decoration:none;">Together Initiatives (p) Limited</a></td></tr></table></div>', '2024-05-25 17:03:25', '2024-05-29 09:57:15'),
	(3, 'CHANGE-PASSWORD', 'Your password has been changed', '<div style="font-family:-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif;background:#f4f4f5;padding:24px;margin:0;"><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:0 auto;"><tr><td style="background:#fff;border-radius:8px;padding:32px 40px;box-shadow:0 1px 3px rgba(0,0,0,0.08);"><table role="presentation" cellpadding="0" cellspacing="0" width="100%"><tr><td style="padding-bottom:20px;border-bottom:1px solid #e4e4e7;"><img src="https://support.i2gether.com/support-together.png" alt="Support Together" style="max-height:48px;display:block;" /></td></tr></table><h2 style="font-size:18px;font-weight:600;color:#18181b;margin:24px 0 8px;">Hi {name},</h2><p style="font-size:15px;line-height:1.6;color:#52525b;margin:0 0 20px;">Your Support Together password has been changed successfully. If you made this change, no further action is needed.</p><p style="margin:0 0 24px;"><a href="https://support.i2gether.com/" style="display:inline-block;background:#2563eb;color:#fff;padding:12px 24px;border-radius:6px;text-decoration:none;font-weight:600;font-size:15px;">Sign in to Support Together</a></p><p style="font-size:13px;color:#71717a;margin:0;">This email was sent to {email}. If you did not change your password, please contact support.</p></td></tr></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:24px auto 0;"><tr><td style="padding-top:20px;border-top:1px solid #e4e4e7;font-size:13px;color:#71717a;text-align:center;">Powered by <a href="https://www.i2gether.com" style="color:#2563eb;text-decoration:none;">Together Initiatives (p) Limited</a></td></tr></table></div>', '2024-05-28 11:24:15', '2024-05-29 10:42:24'),
	(4, 'INVITE', 'You\'re invited to Support Together', '<div style="font-family:-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif;background:#f4f4f5;padding:24px;margin:0;"><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:0 auto;"><tr><td style="background:#fff;border-radius:8px;padding:32px 40px;box-shadow:0 1px 3px rgba(0,0,0,0.08);"><table role="presentation" cellpadding="0" cellspacing="0" width="100%"><tr><td style="padding-bottom:20px;border-bottom:1px solid #e4e4e7;"><img src="https://support.i2gether.com/support-together.png" alt="Support Together" style="max-height:48px;display:block;" /></td></tr></table><h2 style="font-size:18px;font-weight:600;color:#18181b;margin:24px 0 8px;">You\'re invited</h2><p style="font-size:15px;line-height:1.6;color:#52525b;margin:0 0 20px;">You have been invited to join a project on Support Together. Use the credentials below to sign in. We recommend changing your password after your first login.</p><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="border-collapse:collapse;margin:0 0 24px;"><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Email</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{email}</td></tr><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Temporary password</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;font-family:monospace;">{password}</td></tr></table><p style="margin:0 0 24px;"><a href="https://support.i2gether.com/" style="display:inline-block;background:#2563eb;color:#fff;padding:12px 24px;border-radius:6px;text-decoration:none;font-weight:600;font-size:15px;">Sign in to Support Together</a></p><p style="font-size:13px;color:#71717a;margin:0;">This invitation was sent to {email}. If you did not expect this, you can ignore this email.</p></td></tr></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:24px auto 0;"><tr><td style="padding-top:20px;border-top:1px solid #e4e4e7;font-size:13px;color:#71717a;text-align:center;">Powered by <a href="https://www.i2gether.com" style="color:#2563eb;text-decoration:none;">Together Initiatives (p) Limited</a></td></tr></table></div>', '2024-05-29 04:32:33', '2024-05-30 12:04:10'),
	(5, 'PASSWORD-RESET', 'Your Support Together password has been reset', '<div style="font-family:-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif;background:#f4f4f5;padding:24px;margin:0;"><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:0 auto;"><tr><td style="background:#fff;border-radius:8px;padding:32px 40px;box-shadow:0 1px 3px rgba(0,0,0,0.08);"><table role="presentation" cellpadding="0" cellspacing="0" width="100%"><tr><td style="padding-bottom:20px;border-bottom:1px solid #e4e4e7;"><img src="https://support.i2gether.com/support-together.png" alt="Support Together" style="max-height:48px;display:block;" /></td></tr></table><h2 style="font-size:18px;font-weight:600;color:#18181b;margin:24px 0 8px;">Hi {name},</h2><p style="font-size:15px;line-height:1.6;color:#52525b;margin:0 0 20px;">Your password has been reset. Use the temporary password below to sign in. We recommend changing it after your first login.</p><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="border-collapse:collapse;margin:0 0 24px;"><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Your new password</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;font-family:monospace;">{newPassword}</td></tr></table><p style="margin:0 0 24px;"><a href="https://support.i2gether.com/" style="display:inline-block;background:#2563eb;color:#fff;padding:12px 24px;border-radius:6px;text-decoration:none;font-weight:600;font-size:15px;">Sign in to Support Together</a></p><p style="font-size:13px;color:#71717a;margin:0;">If you did not request this reset, please contact support.</p></td></tr></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:24px auto 0;"><tr><td style="padding-top:20px;border-top:1px solid #e4e4e7;font-size:13px;color:#71717a;text-align:center;">Powered by <a href="https://www.i2gether.com" style="color:#2563eb;text-decoration:none;">Together Initiatives (p) Limited</a></td></tr></table></div>', '2024-05-29 09:37:32', '2024-05-30 09:53:51'),
	(6, 'TICKET-ASSIGNMENT', 'New ticket assigned to you: {code}', '<div style="font-family:-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif;background:#f4f4f5;padding:24px;margin:0;"><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:0 auto;"><tr><td style="background:#fff;border-radius:8px;padding:32px 40px;box-shadow:0 1px 3px rgba(0,0,0,0.08);"><table role="presentation" cellpadding="0" cellspacing="0" width="100%"><tr><td style="padding-bottom:20px;border-bottom:1px solid #e4e4e7;"><img src="https://support.i2gether.com/support-together.png" alt="Support Together" style="max-height:48px;display:block;" /></td></tr></table><h2 style="font-size:18px;font-weight:600;color:#18181b;margin:24px 0 8px;">Hi {name},</h2><p style="font-size:15px;line-height:1.6;color:#52525b;margin:0 0 20px;">A support ticket has been assigned to you. Here are the details:</p><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="border-collapse:collapse;margin:0 0 24px;"><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Ticket</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{code}</td></tr><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Title</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{title}</td></tr></table><p style="margin:0 0 24px;"><a href="https://support.i2gether.com/" style="display:inline-block;background:#2563eb;color:#fff;padding:12px 24px;border-radius:6px;text-decoration:none;font-weight:600;font-size:15px;">View ticket</a></p><p style="font-size:13px;color:#71717a;margin:0;">This email was sent to {email}. If you did not expect this, you can ignore it.</p></td></tr></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:24px auto 0;"><tr><td style="padding-top:20px;border-top:1px solid #e4e4e7;font-size:13px;color:#71717a;text-align:center;">Powered by <a href="https://www.i2gether.com" style="color:#2563eb;text-decoration:none;">Together Initiatives (p) Limited</a></td></tr></table></div>', NOW(), NOW()),
	(7, 'PROJECT-ASSIGNMENT', 'You have been added to project {projectName}', '<div style="font-family:-apple-system,BlinkMacSystemFont,\'Segoe UI\',Roboto,sans-serif;background:#f4f4f5;padding:24px;margin:0;"><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:0 auto;"><tr><td style="background:#fff;border-radius:8px;padding:32px 40px;box-shadow:0 1px 3px rgba(0,0,0,0.08);"><table role="presentation" cellpadding="0" cellspacing="0" width="100%"><tr><td style="padding-bottom:20px;border-bottom:1px solid #e4e4e7;"><img src="https://support.i2gether.com/support-together.png" alt="Support Together" style="max-height:48px;display:block;" /></td></tr></table><h2 style="font-size:18px;font-weight:600;color:#18181b;margin:24px 0 8px;">Hi {name},</h2><p style="font-size:15px;line-height:1.6;color:#52525b;margin:0 0 20px;">You have been added to a new project on Support Together. You can now access it and collaborate with your team.</p><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="border-collapse:collapse;margin:0 0 24px;"><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Project</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{projectName}</td></tr><tr><td style="padding:10px 12px;background:#f4f4f5;font-weight:600;color:#52525b;font-size:14px;border:1px solid #e4e4e7;">Your role</td><td style="padding:10px 12px;border:1px solid #e4e4e7;font-size:14px;color:#18181b;">{role}</td></tr></table><p style="margin:0 0 24px;"><a href="https://support.i2gether.com/" style="display:inline-block;background:#2563eb;color:#fff;padding:12px 24px;border-radius:6px;text-decoration:none;font-weight:600;font-size:15px;">Open Support Together</a></p><p style="font-size:13px;color:#71717a;margin:0;">This email was sent to {email}. If you did not expect this, you can ignore it.</p></td></tr></table><table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="max-width:560px;margin:24px auto 0;"><tr><td style="padding-top:20px;border-top:1px solid #e4e4e7;font-size:13px;color:#71717a;text-align:center;">Powered by <a href="https://www.i2gether.com" style="color:#2563eb;text-decoration:none;">Together Initiatives (p) Limited</a></td></tr></table></div>', NOW(), NOW());

