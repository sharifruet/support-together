
INSERT INTO `Users` (`id`, `name`, `email`, `phoneNumber`, `password`, `createdAt`, `updatedAt`) VALUES
(1, 'Sharif', 'sharifruet@gmail.com', '1710455190', '$2b$10$.OxaAxo/Q4pjQWY.sScTWeNsLLf8qORie7qU66VDautltxrc2sDmO', '2024-05-05 10:31:54', '2024-05-05 10:31:54'),
(2, 'Raihan Wahid', 'raihan@i2gether.com', '01716155239', '$2b$10$.OxaAxo/Q4pjQWY.sScTWeNsLLf8qORie7qU66VDautltxrc2sDmO', '2024-06-02 13:20:50', '2024-06-02 16:29:32'),
(3, 'pequ', 'pequ@i2gether.com', '01827680713', '$2b$10$.OxaAxo/Q4pjQWY.sScTWeNsLLf8qORie7qU66VDautltxrc2sDmO', '2024-06-03 05:23:59', '2024-06-03 05:28:05');


-- --------------------------------------------------------

INSERT INTO `Organizations` (`id`, `code`, `name`, `address`, `createdAt`, `updatedAt`) VALUES
(1, 'TIL', 'Together Initiatives', '1234 Main St', '2024-05-06 10:09:03', '2024-05-24 12:07:28');

-- --------------------------------------------------------

--
-- Dumping data for table `Projects`
--

INSERT INTO `Projects` (`id`, `code`, `name`, `description`, `createdAt`, `updatedAt`, `OrganizationId`) VALUES
(1, 'EBPM', 'Ebpm', 'Together ebpm', '2024-06-02 13:19:22', '2024-06-02 13:19:22', 1);

-- --------------------------------------------------------


-- Triggers `Tickets`
--
DELIMITER $$
CREATE TRIGGER `before_insert_ticket` BEFORE INSERT ON `Tickets` FOR EACH ROW BEGIN
    DECLARE project_code VARCHAR(255);
    DECLARE ticket_count INT;

    -- Fetch the project code
    SELECT code INTO project_code FROM Projects WHERE id = (SELECT projectId FROM Topics WHERE id = NEW.topicId);

    -- Count existing tickets for the project
    SELECT COUNT(*) + 1 INTO ticket_count FROM Tickets t 
    INNER JOIN Topics t1 ON (t.topicId = t1.id)
    INNER JOIN Topics t2 ON (t1.ProjectId = t2.ProjectId)
    WHERE t2.id = NEW.topicId;

    -- Set the code for the new ticket
    SET NEW.code = CONCAT(project_code, '-', ticket_count);
END
$$
DELIMITER ;





-- --------------------------------------------------------


INSERT INTO `Topics` (`id`, `name`, `description`, `createdAt`, `updatedAt`, `ProjectId`) VALUES
(2, 'New Issue', 'Description of Topic 1', '2024-05-08 12:36:32', '2024-05-08 12:36:32', 1),
(3, 'Old Issue', 'Description of Topic 1', '2024-05-08 12:36:56', '2024-05-08 12:36:56', 1);

-- --------------------------------------------------------

--
-- Dumping data for table `UserRoles`
--


INSERT INTO `UserRoles` (`id`, `role`, `createdAt`, `updatedAt`, `UserId`, `ProjectId`) VALUES
(1, 'Admin', '2024-05-06 10:12:44', '2024-05-06 10:12:44', 1, 1),
(2, 'Customer', '2024-06-02 13:19:48', '2024-06-02 13:19:48', 2, 1),
(3, 'Support', '2024-06-02 13:21:09', '2024-06-02 13:21:09', 3, 1);

-- --------------------------------------------------------

INSERT INTO `EmailTemplates` (`id`, `name`, `subject`, `body`, `createdAt`, `updatedAt`) VALUES
	(1, 'TICKET-CREATE', 'Ticket [{code}] Created', '<div style="background-color:#F5F5F5;">\r\n  <div style="display:flex; justify-left: left; align-items: center;">\r\n    <img alt="Support-Toger" src="https://support.i2gether.com/support-together.png" style="max-height:80px;"/>\r\n    <h3>[Support Together]</h3>\r\n  </div>\r\n  <div style="margin: 20px 10px; text-align: left; background-color:#FFF;">\r\n    <h4>Hi, {name}</h4>\r\n    <hr style="color:#d9d9d9;background-color:#d9d9d9;height:1px;margin:20px 0;border-style:none"/>\r\n    <p> You have just created a ticket at Support Together.</p>\r\n    <br/>\r\n    <table>\r\n      <tr>\r\n        <th>Code </th> <td>{code}</td>\r\n      </tr>\r\n      <tr>\r\n        <th>Title </th> <td>{title}</td>\r\n      </tr>\r\n      <tr>\r\n        <th>Created on </th> <td>{createdAt}</td>\r\n      </tr>\r\n    </table>\r\n    <br/>\r\n    <a href="https://support.i2gether.com/ticket/{code}" style="display:inline-block;color:#fff;font-size:14px;font-weight:600;background-color:#4183c4;text-decoration:none;width:auto!important;text-align:center;border-radius:5px;letter-spacing:normal;font-family:\'Helvetica Neue\',Helvetica,Arial,sans-serif;margin:0 auto;padding:6px 12px" target="_blank">View Ticket</a>\r\n    <br/><br/>\r\n    <p><strong>Note:</strong> This ticket was intended for {email}. If you were not expecting this invitation, you can ignore this email.</p>\r\n    <hr style="color:#d9d9d9;background-color:#d9d9d9;height:1px;margin:20px 0;border-style:none"/>\r\n    <p style="word-wrap:normal;font-family:\'Helvetica Neue\',Helvetica,Arial,sans-serif;font-size:12px;font-weight:normal;color:#777777;line-height:20px;text-align:left;margin:15px 0 5px;padding:0" align="left">\r\n      <strong>Button not working?</strong> Copy and paste this link into your browser:\r\n      <br><a href="https://support.i2gether.com" style="color:#4183c4;text-decoration:none" target="_blank">https://support.i2gether.com/<wbr>invitations</a>\r\n  </p>\r\n  </div>\r\n  <div style="text-align:center;padding:10" align="center">\r\n    <p style="color:#999;text-align:center;" align="center">\r\n      Powered by <a href="https://www.i2gether.com" target="_blank">\r\n      <img src="https://i2gether.com/img/company_logo.png" style="height: 20px;"> Together Initiatives (p) Limited</a>\r\n    </p>\r\n  </div>\r\n</div>', '2024-05-25 16:58:51', '2024-05-29 09:44:34'),
	(2, 'TICKET-UPDATE', 'Ticket updated', '<div style="background-color:#F5F5F5;">\r\n  <div style="display:flex; justify-left: left; align-items: center;">\r\n    <img alt="Support-Toger" src="https://support.i2gether.com/support-together.png" style="max-height:80px;"/>\r\n    <h3>[Support Together]</h3>\r\n  </div>\r\n  <div style="margin: 20px 10px; text-align: left; background-color:#FFF;">\r\n    <h4>Hi, {name}</h4>\r\n    <hr style="color:#d9d9d9;background-color:#d9d9d9;height:1px;margin:20px 0;border-style:none"/>\r\n    <p> Your have a update on a ticket at Support Together.</p>\r\n    <br/>\r\n    <table>\r\n      <tr>\r\n        <th>Code </th> <td>{code}</td>\r\n      </tr>\r\n      <tr>\r\n        <th>Title </th> <td>{title}</td>\r\n      </tr>\r\n      <tr>\r\n        <th>Created on </th> <td>{createdAt}</td>\r\n      </tr>\r\n       <tr>\r\n        <th>Status </th> <td>{status}</td>\r\n      </tr>\r\n    </table>\r\n    <br/>\r\n    <a href="https://support.i2gether.com/ticket/{code}" style="display:inline-block;color:#fff;font-size:14px;font-weight:600;background-color:#4183c4;text-decoration:none;width:auto!important;text-align:center;border-radius:5px;letter-spacing:normal;font-family:\'Helvetica Neue\',Helvetica,Arial,sans-serif;margin:0 auto;padding:6px 12px" target="_blank">View Ticket</a>\r\n    <br/><br/>\r\n    <p><strong>Note:</strong> This ticket was intended for {email}. If you were not expecting this invitation, you can ignore this email.</p>\r\n    <hr style="color:#d9d9d9;background-color:#d9d9d9;height:1px;margin:20px 0;border-style:none"/>\r\n    <p style="word-wrap:normal;font-family:\'Helvetica Neue\',Helvetica,Arial,sans-serif;font-size:12px;font-weight:normal;color:#777777;line-height:20px;text-align:left;margin:15px 0 5px;padding:0" align="left">\r\n      <strong>Button not working?</strong> Copy and paste this link into your browser:\r\n      <br><a href="https://support.i2gether.com" style="color:#4183c4;text-decoration:none" target="_blank">https://support.i2gether.com/<wbr>invitations</a>\r\n  </p>\r\n  </div>\r\n  <div style="text-align:center;padding:10" align="center">\r\n    <p style="color:#999;text-align:center;" align="center">\r\n      Powered by <a href="https://www.i2gether.com" target="_blank">\r\n      <img src="https://i2gether.com/img/company_logo.png" style="height: 20px;"> Together Initiatives (p) Limited</a>\r\n    </p>\r\n  </div>\r\n</div>', '2024-05-25 17:03:25', '2024-05-29 09:57:15'),
	(3, 'CHANGE-PASSWORD', 'Password changed', '<div style="background-color:#F5F5F5;">\n  <div style="display:flex; justify-left: left; align-items: center;">\n    <img alt="Support-Toger" src="https://support.i2gether.com/support-together.png" style="max-height:80px;"/>\n    <h3>[Support Together]</h3>\n  </div>\n  <div style="margin: 20px 10px; text-align: left; background-color:#FFF;">\n    <h4>Hi, {name}</h4>\n    <hr style="color:#d9d9d9;background-color:#d9d9d9;height:1px;margin:20px 0;border-style:none"/>\n    <p> Your password has been changed.</p>\n    <br/>\n    <a href="https://support.i2gether.com/" style="display:inline-block;color:#fff;font-size:14px;font-weight:600;background-color:#4183c4;text-decoration:none;width:auto!important;text-align:center;border-radius:5px;letter-spacing:normal;font-family:\'Helvetica Neue\',Helvetica,Arial,sans-serif;margin:0 auto;padding:6px 12px" target="_blank">Please Login</a>\n    <br/><br/>\n    <p><strong>Note:</strong> This ticket was intended for {email}. If you were not expecting this invitation, you can ignore this email.</p>\n    <hr style="color:#d9d9d9;background-color:#d9d9d9;height:1px;margin:20px 0;border-style:none"/>\n    <p style="word-wrap:normal;font-family:\'Helvetica Neue\',Helvetica,Arial,sans-serif;font-size:12px;font-weight:normal;color:#777777;line-height:20px;text-align:left;margin:15px 0 5px;padding:0" align="left">\n      <strong>Button not working?</strong> Copy and paste this link into your browser:\n      <br><a href="https://support.i2gether.com" style="color:#4183c4;text-decoration:none" target="_blank">https://support.i2gether.com</a>\n  </p>\n  </div>\n  <div style="text-align:center;padding:10" align="center">\n    <p style="color:#999;text-align:center;" align="center">\n      Powered by <a href="https://www.i2gether.com" target="_blank">\n      <img src="https://i2gether.com/img/company_logo.png" style="height: 20px;"> Together Initiatives (p) Limited</a>\n    </p>\n  </div>\n</div>', '2024-05-28 11:24:15', '2024-05-29 10:42:24'),
	(4, 'INVITE', 'Invitation from support-together', '<div style="background-color:#f5f5f5;">\n  <div style="display:flex; justify-content: center; align-items: center;">\n    <img alt="Support-Toger" src="https://support.i2gether.com/support-together.png" style="max-height:80px;"/>\n    <h3>[Support Together]</h3>\n  </div>\n  <div style="margin: 20px 10px; text-align: center; background-color:#FFF;">\n    <h4>You have been invited to a project of support-together.</h4>\n    <h5>Your password is: {password}</h5>\n    <hr style="color:#d9d9d9;background-color:#d9d9d9;height:1px;margin:20px 0;border-style:none"/>\n    <p> Please log in and change your password.</p>\n    <br/>\n    <a href="https://support.i2gether.com/" style="display:inline-block;color:#fff;font-size:14px;font-weight:600;background-color:#4183c4;text-decoration:none;width:auto!important;text-align:center;border-radius:5px;letter-spacing:normal;font-family:\'Helvetica Neue\',Helvetica,Arial,sans-serif;margin:0 auto;padding:6px 12px" target="_blank">Open invitation</a>\n    <br/><br/>\n    <p><strong>Note:</strong> This invitation was intended for {email}. If you were not expecting this invitation, you can ignore this email.</p>\n    <hr style="color:#d9d9d9;background-color:#d9d9d9;height:1px;margin:20px 0;border-style:none"/>\n    <p style="word-wrap:normal;font-family:\'Helvetica Neue\',Helvetica,Arial,sans-serif;font-size:12px;font-weight:normal;color:#777777;line-height:20px;text-align:left;margin:15px 0 5px;padding:0" align="left">\n      <strong>Button not working?</strong> Copy and paste this link into your browser:\n      <br><a href="https://support.i2gether.com" style="color:#4183c4;text-decoration:none" target="_blank">https://support.i2gether.com</a>\n  </p>\n  </div>\n  <div style="text-align:center;padding:10" align="center">\n    <p style="color:#999;text-align:center;" align="center">\n      Powered by <a href="https://www.i2gether.com" target="_blank">\n      <img src="https://i2gether.com/img/company_logo.png" style="height: 20px;"> Together Initiatives (p) Limited</a>\n    </p>\n  </div>\n</div>', '2024-05-29 04:32:33', '2024-05-30 12:04:10'),
	(5, 'PASSWORD-RESET', 'Password Reset Request', '<!DOCTYPE html>\n<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">\n<head>\n    <meta charset="utf-8"> \n    <meta name="viewport" content="width=device-width"> \n    <meta http-equiv="X-UA-Compatible" content="IE=edge"> \n    <meta name="x-apple-disable-message-reformatting">  \n    <title></title>\n	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">\n	<style>\n			html,\n			body {\n				margin: 0 auto !important;\n				padding: 0 !important;\n				height: 100% !important;\n				width: 100% !important;\n				background: #f1f1f1;\n			}\n			* {\n				-ms-text-size-adjust: 100%;\n				-webkit-text-size-adjust: 100%;\n			}\n			div[style*="margin: 16px 0"] {\n				margin: 0 !important;\n			}\n			table,\n			td {\n				mso-table-lspace: 0pt !important;\n				mso-table-rspace: 0pt !important;\n			}\n			table {\n				border-spacing: 0 !important;\n				border-collapse: collapse !important;\n				table-layout: fixed !important;\n				margin: 0 auto !important;\n			}\n			img {\n				-ms-interpolation-mode:bicubic;\n			}\n			a {\n				text-decoration: none;\n			}\n			.unstyle-auto-detected-links *,\n			.aBn {\n				border-bottom: 0 !important;\n				cursor: default !important;\n				color: inherit !important;\n				text-decoration: none !important;\n				font-size: inherit !important;\n				font-family: inherit !important;\n				font-weight: inherit !important;\n				line-height: inherit !important;\n			}\n			.a6S {\n				display: none !important;\n				opacity: 0.01 !important;\n			}\n			.im {\n				color: inherit !important;\n			}\n			img.g-img + div {\n				display: none !important;\n			}\n			@media only screen and (min-device-width: 320px) and (max-device-width: 374px) {\n				u ~ div .email-container {\n					min-width: 320px !important;\n				}\n			}\n			@media only screen and (min-device-width: 375px) and (max-device-width: 413px) {\n				u ~ div .email-container {\n					min-width: 375px !important;\n				}\n			}\n			@media only screen and (min-device-width: 414px) {\n				u ~ div .email-container {\n					min-width: 414px !important;\n				}\n			}\n			.primary{\n				background: #30e3ca;\n			}\n			.bg_white{\n				background: #ffffff;\n			}\n			.bg_light{\n				background: #fafafa;\n			}\n			.bg_black{\n				background: #000000;\n			}\n			.bg_dark{\n				background: rgba(0,0,0,.8);\n			}\n			.email-section{\n				padding:2.5em;\n			}\n			.btn{\n				padding: 10px 15px;\n				display: inline-block;\n			}\n			.btn.btn-primary{\n				border-radius: 5px;\n				background: #30e3ca;\n				color: #ffffff;\n			}\n			.btn.btn-white{\n				border-radius: 5px;\n				background: #ffffff;\n				color: #000000;\n			}\n			.btn.btn-white-outline{\n				border-radius: 5px;\n				background: transparent;\n				border: 1px solid #fff;\n				color: #fff;\n			}\n			.btn.btn-black-outline{\n				border-radius: 0px;\n				background: transparent;\n				border: 2px solid #000;\n				color: #000;\n				font-weight: 700;\n			}\n			h1,h2,h3,h4,h5,h6{\n				font-family: \'Lato\', sans-serif;\n				color: #000000;\n				margin-top: 0;\n				font-weight: 400;\n			}\n			body{\n				font-family: \'Lato\', sans-serif;\n				font-weight: 400;\n				font-size: 15px;\n				line-height: 1.8;\n				color: rgba(0,0,0,.4);\n			}\n			a{\n				color: #088dd5;\n			}\n			table{\n			}\n			.logo h1{\n				margin: 0;\n			}\n			.logo h1 a{\n				color: #30e3ca;\n				font-size: 24px;\n				font-weight: 700;\n				font-family: \'Lato\', sans-serif;\n			}\n			.hero{\n				position: relative;\n				z-index: 0;\n			}\n			.hero .text{\n				color: rgba(0,0,0,.3);\n			}\n			.hero .text h2{\n				color: #000;\n				font-size: 40px;\n				margin-bottom: 0;\n				font-weight: 400;\n				line-height: 1.4;\n			}\n			.hero .text h3{\n				font-size: 24px;\n				font-weight: 300;\n			}\n			.hero .text h2 span{\n				font-weight: 600;\n				color: #30e3ca;\n			}\n\n			.heading-section{\n			}\n			.heading-section h2{\n				color: #000000;\n				font-size: 28px;\n				margin-top: 0;\n				line-height: 1.4;\n				font-weight: 400;\n			}\n			.heading-section .subheading{\n				margin-bottom: 20px !important;\n				display: inline-block;\n				font-size: 13px;\n				text-transform: uppercase;\n				letter-spacing: 2px;\n				color: rgba(0,0,0,.4);\n				position: relative;\n			}\n			.heading-section .subheading::after{\n				position: absolute;\n				left: 0;\n				right: 0;\n				bottom: -10px;\n				content: \'\';\n				width: 100%;\n				height: 2px;\n				background: #30e3ca;\n				margin: 0 auto;\n			}\n			.heading-section-white{\n				color: rgba(255,255,255,.8);\n			}\n			.heading-section-white h2{\n				font-family: \n				line-height: 1;\n				padding-bottom: 0;\n			}\n			.heading-section-white h2{\n				color: #ffffff;\n			}\n			.heading-section-white .subheading{\n				margin-bottom: 0;\n				display: inline-block;\n				font-size: 13px;\n				text-transform: uppercase;\n				letter-spacing: 2px;\n				color: rgba(255,255,255,.4);\n			}\n			ul.social{\n				padding: 0;\n			}\n			ul.social li{\n				display: inline-block;\n				margin-right: 10px;\n			}\n			.footer{\n				border-top: 1px solid rgba(0,0,0,.05);\n				color: rgba(0,0,0,.5);\n			}\n			.footer .heading{\n				color: #000;\n				font-size: 20px;\n			}\n			.footer ul{\n				margin: 0;\n				padding: 0;\n			}\n			.footer ul li{\n				list-style: none;\n				margin-bottom: 10px;\n			}\n			.footer ul li a{\n				color: rgba(0,0,0,1);\n			}\n			@media screen and (max-width: 500px) {\n			}\n    </style>\n</head>\n<body width="100%" style="margin: 0; padding: 0 !important; mso-line-height-rule: exactly; background-color: #f1f1f1;">\n	<center style="width: 100%; background-color: #f1f1f1;">\n    <div style="display: none; font-size: 1px;max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden; mso-hide: all; font-family: sans-serif;">  &zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;\n    </div>\n    <div style="max-width: 600px; margin: 0 auto;" class="email-container">\n    	<!-- BEGIN BODY -->\n      <table align="center" role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin: auto;">\n      	<tr>\n          <td valign="top" class="bg_white" style="padding: 1em 2.5em 0 2.5em;">\n          	<table role="presentation" border="0" cellpadding="0" cellspacing="0" width="100%">\n          		<tr>\n          			<td class="logo" style="text-align: center;">\n			            <h1><a href="#">Together Support Hub</a></h1>\n			          </td>\n          		</tr>\n          	</table>\n          </td>\n	    </tr><!-- end tr -->\n		<tr>\n          <td valign="middle" class="hero bg_white" style="padding: 2em 0 4em 0;">\n            <table>\n            	<tr>\n            		<td>\n            			<div class="text" style="padding: 0 2.5em; text-align: left;">\n            				<h5>Hi, {name}\n							<br>You have been invited to our system. Your password is: <b> {newPassword} </b> </h5>\n							<p>Please log in and change your password as soon as possible. <a href="https://support.i2gether.com/" target="_blank">Login now</a><p/> \n							<p>Thank you.</p>\n            			</div>\n            		</td>\n            	</tr>\n            </table>\n          </td>\n	    </tr>\n      </table>\n      <table align="center" role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin: auto;">\n        <tr>\n          <td class="bg_light" style="text-align: center;">\n          	<p>Powered by<a href="https://i2gether.com/" target="_blank"><img src="https://i2gether.com/img/company_logo.png" style="height: 20px;"></a>  Together Initiatives (p) Limites</p>\n          </td>\n        </tr>\n      </table>\n    </div>\n  </center>\n</body>\n</html>\n', '2024-05-29 09:37:32', '2024-05-30 09:53:51');

